<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì¥ê¸°ê²°ì„ ê²½ê³  ë¦¬í¬íŠ¸</title>
    <style>
        body { font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif; padding: 20px; background: #f0f2f5; }
        h2 { text-align: center; color: #333; margin-bottom: 10px; }
        .subtitle { text-align: center; color: #666; font-size: 0.9em; margin-bottom: 30px; }
        
        .card { background: #fff; padding: 15px; margin-bottom: 10px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); border-left: 6px solid #ccc; }
        
        /* ë‹¨ê³„ë³„ ìƒ‰ìƒ í´ë˜ìŠ¤ */
        .bg-green { border-left-color: #28a745; }
        .bg-yellow { border-left-color: #ffc107; background-color: #fffbf2; }
        .bg-orange { border-left-color: #fd7e14; background-color: #fff5eb; }
        .bg-red { border-left-color: #dc3545; background-color: #ffeef0; }
        .bg-black { border-left-color: #212529; background-color: #e2e3e5; }
        
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .name-tag { font-size: 1.2em; font-weight: bold; }
        
        .status-badge { padding: 4px 8px; border-radius: 4px; font-size: 0.85em; font-weight: bold; color: #fff; background: #666; }
        /* ë±ƒì§€ ë°°ê²½ìƒ‰ */
        .status-bg-green { background: #28a745; }
        .status-bg-yellow { background: #ffc107; color: #000; }
        .status-bg-orange { background: #fd7e14; }
        .status-bg-red { background: #dc3545; }
        .status-bg-black { background: #212529; }

        .progress-bg { width: 100%; background: #e9ecef; height: 10px; border-radius: 5px; margin: 10px 0; overflow: hidden; }
        .progress-bar { height: 100%; transition: width 0.5s; }
        
        .consecutive-box { margin-top: 12px; background-color: #fff5f5; border: 1px solid #feb2b2; border-radius: 6px; padding: 10px; }
        .consecutive-title { color: #c53030; font-weight: bold; font-size: 0.9em; margin-bottom: 6px; }
        .consecutive-item { padding: 3px 0; border-bottom: 1px dashed #eee; font-size: 0.9em; }
        .day-badge { background-color: #fc8181; color: white; padding: 1px 6px; border-radius: 10px; font-size: 0.8em; font-weight: bold; margin-left: 6px; }

        .details { font-size: 0.85em; color: #555; margin-top: 8px; line-height: 1.4; }
    </style>
</head>
<body>
    
    <h2>ğŸ“‰ ì¥ê¸°ê²°ì„(ì§ˆë³‘/ë¯¸ì¸ì •/ê¸°íƒ€) ê´€ë¦¬ ë¦¬í¬íŠ¸</h2>
    <div class="subtitle">ê¸°ì¤€: {{ limits.l1 }}ì¼(1ì°¨) â†’ {{ limits.l2 }}ì¼(2ì°¨) â†’ {{ limits.l3 }}ì¼(ë‚´êµ) â†’ {{ limits.l4 }}ì¼(ì •ì›ì™¸)</div>
    <div style="text-align:center; font-size:0.85em; color:#666; margin-bottom:20px;">â€» ì—°ì† {{ limits.consecutive }}ì¼ ì´ìƒ(ìˆ˜ì—…ì¼ ê¸°ì¤€, íœ´ì¼ ì œì™¸) ê²°ì„ ì‹œ ìƒì„¸ êµ¬ê°„ì´ í‘œì‹œë©ë‹ˆë‹¤.</div>
    
    <div style="max-width: 800px; margin: 0 auto;">
        {% if not rows %}
            <div style="text-align:center; color:#aaa; margin-top:50px;">ê²°ì„ ì¼ìˆ˜ê°€ ìˆëŠ” í•™ìƒì´ ì—†ìŠµë‹ˆë‹¤.</div>
        {% else %}
            {% for row in rows %}
            <div class="card {{ row.color_class }}">
                <div class="header">
                    <span class="name-tag">{{ row.num }}ë²ˆ {{ row.name }} <span style="font-size:0.8em; color:#666">({{ row.count }}ì¼ ëˆ„ì )</span></span>
                    <span class="status-badge status-{{ row.color_class }}">{{ row.msg }}</span>
                </div>
                <div class="progress-bg">
                    <div class="progress-bar" style="width: {{ row.pct }}%; background-color: {{ row.bar_color }};"></div>
                </div>
                <div class="details">ğŸ“ ì „ì²´ ìƒì„¸: {{ row.details }}</div>

                {% if row.long_periods %}
                <div class="consecutive-box">
                    <div class="consecutive-title">ğŸš¨ ì—°ì† ê²°ì„ ì£¼ì˜ êµ¬ê°„ (ìˆ˜ì—…ì¼ìˆ˜ ê¸°ì¤€)</div>
                    {% for p in row.long_periods %}
                    <div class="consecutive-item">â€¢ {{ p.start_str }} ~ {{ p.end_str }} <span class="day-badge">{{ p.days }}ì¼ê°„</span></div>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
            {% endfor %}
        {% endif %}
    </div>

</body>
</html>